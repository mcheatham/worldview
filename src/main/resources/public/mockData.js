require([
	'dojo/request/registry',
	'dojo/io-query',
	'dojo/when'
], function (registry, ioQuery, when) {
	function logRequest(url, options) {
		console.log(url + ' - [' + options.method + '] - ' + ioQuery.objectToQuery(options.query));
	}

	function queryParam(query, name) {
		if (query[name] == null) {
			console.error('Missing required query param "' + name + '"');
		}
		return query[name];
	}

	var ontologies = [
		{
			id: 'ont1',
			label: 'Ontology 1',
			entities: [
				{
					uri: 'http://geo.com/ent1-1',
					label: 'O1 Entity 1'
				},
				{
					uri: 'http://geo.com/ent1-2',
					label: 'O1 Entity 2'
				},
				{
					uri: 'http://geo.com/ent1-3',
					label: 'O1 Entity 3'
				}
			]
		},
		{
			id: 'ont2',
			label: 'Ontology 2',
			entities: [
				{
					uri: 'http://geo.com/ent2-1',
					label: 'O2 Entity 1'
				},
				{
					uri: 'http://geo.com/ent2-2',
					label: 'O2 Entity 2'
				},
				{
					uri: 'http://geo.com/ent2-3',
					label: 'O2 Entity 3'
				}
			]
		}
	];

	var coordinates = [
		{
			id: 'maine',
			coordinates: [
				[-67.13734351262877, 45.137451890638886],
				[-66.96466, 44.8097],
				[-68.03252, 44.3252],
				[-69.06, 43.98],
				[-70.11617, 43.68405],
				[-70.64573401557249, 43.090083319667144],
				[-70.75102474636725, 43.08003225358635],
				[-70.79761105007827, 43.21973948828747],
				[-70.98176001655037, 43.36789581966826],
				[-70.94416541205806, 43.46633942318431],
				[-71.08482, 45.3052400000002],
				[-70.6600225491012, 45.46022288673396],
				[-70.30495378282376, 45.914794623389355],
				[-70.00014034695016, 46.69317088478567],
				[-69.23708614772835, 47.44777598732787],
				[-68.90478084987546, 47.184794623394396],
				[-68.23430497910454, 47.35462921812177],
				[-67.79035274928509, 47.066248887716995],
				[-67.79141211614706, 45.702585354182816],
				[-67.13734351262877, 45.137451890638886]
			]
		},
		{
			id: 'bermuda triangle',
			coordinates: [
				[-64.73, 32.31],
				[-80.19, 25.76],
				[-66.09, 18.43],
				[-64.73, 32.31]
			]
		},
		{
			id: 'flemish diamond',
			coordinates:[
				[3.55, 51.08],
				[4.36, 50.73],
				[4.84, 50.85],
				[4.45, 51.30],
				[3.55, 51.08]
			]
		},
		{
			id: 'research triangle',
			coordinates: [
				[-78.93, 36.00],
				[-78.67, 35.78],
				[-79.04, 35.90],
				[-78.93, 36.00]
			]
		}
	];

	// registry.register('/ontologies', function (url, options) {
	// 	logRequest(url, options);
	// 	return when(ontologies.map(function (ontology) {
	// 		return { id: ontology.id, label: ontology.label };
	// 	}));
	// });

	// registry.register('/entities', function (url, options) {
	// 	logRequest(url, options);
	// 	var query = options.query;
	// 	var ontology = ontologies.find(function (ontology) {
	// 		return ontology.id === queryParam(query, 'ontology');
	// 	});
	// 	return when(ontology.entities);
	// });

	registry.register('/relatedEntities', function (url, options) {
		logRequest(url, options);
		var query = options.query;
		var ont1 = ontologies.find(function (ontology) {
			return ontology.id === queryParam(query, 'ontology1');
		});
		var ont2 = ontologies.find(function (ontology) {
			return ontology.id === queryParam(query, 'ontology2');
		});
		var ent1 = ont1.entities.find(function (entity) {
			return entity.id === queryParam(query, 'entity');
		});
		return when(ont2.entities);
	});

	// registry.register('/axioms', function (url, options) {
	// 	logRequest(url, options);
	// 	var query = options.query;
	// 	var ont1 = ontologies.find(function (ontology) {
	// 		return ontology.id === queryParam(query, 'ontology1');
	// 	});
	// 	var ont2 = ontologies.find(function (ontology) {
	// 		return ontology.id === queryParam(query, 'ontology2');
	// 	});
	// 	var ent1 = ont1.entities.find(function (entity) {
	// 		return entity.uri === queryParam(query, 'entity');
	// 	});
	// 	return when(ont1.entities.map(function (entity) {
	// 		var ont2Entities = ont2.entities.slice();
	// 		var ent1 = ont2Entities.splice(Math.floor(Math.random() * ont2Entities.length), 1)[0];
	// 		var ent2 = ont2Entities.splice(Math.floor(Math.random() * ont2Entities.length), 1)[0];

	// 		return {
	// 			id: '<xml><' + Math.random() + '/></xml>',
	// 			label: 'A ' + entity.label + ' is a subclass of ' + ent1.label + ' that has the property ' + ent2.label,
	// 			entities: [ ent1, ent2 ]
	// 		};
	// 	}));
	// });

	registry.register('/coordinates', function (url, options) {
		// logRequest(url, options);
		// var query = options.query;
		// var axiom = queryParam(query, 'axiom');
		// var lat = queryParam(query, 'lat');
		// var lng = queryParam(query, 'lng');
		// var ont1 = ontologies.find(function (ontology) {
		// 	return ontology.id === queryParam(query, 'ontology1');
		// });
		// var ont2 = ontologies.find(function (ontology) {
		// 	return ontology.id === queryParam(query, 'ontology2');
		// });
		// var coords = coordinates[Math.floor(Math.random() * coordinates.length)];
		// return when([
		// 	{
		// 		entity: ont1.entities[0],
		// 		// coordinates: coords.coordinates
		// 		coordinates: coords.coordinates
		// 	}
		// ]);

		return when(JSON.stringify({
			"<http://cegis.usgs.gov/SWO/LakeOrPond> (lake or pond) in USGS.owl": [
				{
					"points": [
						{
							"lat": 39.3767438722,
							"lng": -82.2378961828
						},
						{
							"lat": 39.3765790722,
							"lng": -82.2378889828
						},
						{
							"lat": 39.3764802055,
							"lng": -82.2379455161
						},
						{
							"lat": 39.3763648722,
							"lng": -82.2379665828
						},
						{
							"lat": 39.3762550055,
							"lng": -82.2379523828
						},
						{
							"lat": 39.3761890722,
							"lng": -82.2379381828
						},
						{
							"lat": 39.3761726055,
							"lng": -82.2380159828
						},
						{
							"lat": 39.3761836055,
							"lng": -82.2380655161
						},
						{
							"lat": 39.3762440055,
							"lng": -82.2381505161
						},
						{
							"lat": 39.3763646722,
							"lng": -82.2383203828
						},
						{
							"lat": 39.3764250722,
							"lng": -82.2383983828
						},
						{
							"lat": 39.3764854722,
							"lng": -82.2384621161
						},
						{
							"lat": 39.3765184055,
							"lng": -82.2384833828
						},
						{
							"lat": 39.3766448722,
							"lng": -82.2382003828
						},
						{
							"lat": 39.3767492722,
							"lng": -82.2380305828
						},
						{
							"lat": 39.3767878055,
							"lng": -82.2379457161
						},
						{
							"lat": 39.3767438722,
							"lng": -82.2378961828
						}
					]
				},
				{
					"points": [
						{
							"lat": 39.4408134721,
							"lng": -82.2861233827
						},
						{
							"lat": 39.4408354721,
							"lng": -82.2861163827
						},
						{
							"lat": 39.4408520054,
							"lng": -82.286095116
						},
						{
							"lat": 39.4408574721,
							"lng": -82.2860667827
						},
						{
							"lat": 39.4408574721,
							"lng": -82.2860313827
						},
						{
							"lat": 39.4408410054,
							"lng": -82.2859959827
						},
						{
							"lat": 39.4408134721,
							"lng": -82.2859605827
						},
						{
							"lat": 39.4407476054,
							"lng": -82.285925116
						},
						{
							"lat": 39.4406212721,
							"lng": -82.2859039827
						},
						{
							"lat": 39.4405554054,
							"lng": -82.285896916
						},
						{
							"lat": 39.4405498721,
							"lng": -82.286151916
						},
						{
							"lat": 39.4405828721,
							"lng": -82.2861659827
						},
						{
							"lat": 39.4406322721,
							"lng": -82.2861659827
						},
						{
							"lat": 39.4407586054,
							"lng": -82.2861375827
						},
						{
							"lat": 39.4408134721,
							"lng": -82.2861233827
						}
					]
				},
				{
					"points": [
						{
							"lat": 39.4149510055,
							"lng": -82.285757316
						},
						{
							"lat": 39.4150554055,
							"lng": -82.285828116
						},
						{
							"lat": 39.4151102722,
							"lng": -82.2858775827
						},
						{
							"lat": 39.4151378055,
							"lng": -82.285905916
						},
						{
							"lat": 39.4151598055,
							"lng": -82.285905916
						},
						{
							"lat": 39.4151706722,
							"lng": -82.2858775827
						},
						{
							"lat": 39.4151708055,
							"lng": -82.285849316
						},
						{
							"lat": 39.4151596722,
							"lng": -82.2857783827
						},
						{
							"lat": 39.4151212722,
							"lng": -82.285721916
						},
						{
							"lat": 39.4150664055,
							"lng": -82.285672316
						},
						{
							"lat": 39.4149728722,
							"lng": -82.2856085827
						},
						{
							"lat": 39.4148796055,
							"lng": -82.285509516
						},
						{
							"lat": 39.4147476722,
							"lng": -82.285417516
						},
						{
							"lat": 39.4146378722,
							"lng": -82.2853325827
						},
						{
							"lat": 39.4145500055,
							"lng": -82.2852759827
						},
						{
							"lat": 39.4144786055,
							"lng": -82.2852193827
						},
						{
							"lat": 39.4143522722,
							"lng": -82.2850991161
						},
						{
							"lat": 39.4143138055,
							"lng": -82.2850707161
						},
						{
							"lat": 39.4142864055,
							"lng": -82.2850707827
						},
						{
							"lat": 39.4142698722,
							"lng": -82.2850777827
						},
						{
							"lat": 39.4142588722,
							"lng": -82.2851061827
						},
						{
							"lat": 39.4142644055,
							"lng": -82.2851273827
						},
						{
							"lat": 39.4143192722,
							"lng": -82.2852193827
						},
						{
							"lat": 39.4144182055,
							"lng": -82.2853537827
						},
						{
							"lat": 39.4145226055,
							"lng": -82.2854671827
						},
						{
							"lat": 39.4146158722,
							"lng": -82.2855519827
						},
						{
							"lat": 39.4146654055,
							"lng": -82.285587516
						},
						{
							"lat": 39.4147752722,
							"lng": -82.285644116
						},
						{
							"lat": 39.4148686722,
							"lng": -82.285700716
						},
						{
							"lat": 39.4149510055,
							"lng": -82.285757316
						}
					]
				},
				{
					"points": [
						{
							"lat": 39.4087636722,
							"lng": -82.303041316
						},
						{
							"lat": 39.4088626055,
							"lng": -82.303126316
						},
						{
							"lat": 39.4089614055,
							"lng": -82.303175916
						},
						{
							"lat": 39.4090328722,
							"lng": -82.3031687827
						},
						{
							"lat": 39.4090822722,
							"lng": -82.303133316
						},
						{
							"lat": 39.4091042055,
							"lng": -82.3030837827
						},
						{
							"lat": 39.4091096722,
							"lng": -82.303041316
						},
						{
							"lat": 39.4090822722,
							"lng": -82.302956316
						},
						{
							"lat": 39.4090548055,
							"lng": -82.3028501827
						},
						{
							"lat": 39.4090548055,
							"lng": -82.302807716
						},
						{
							"lat": 39.4090602722,
							"lng": -82.302772316
						},
						{
							"lat": 39.4090712055,
							"lng": -82.3027297827
						},
						{
							"lat": 39.4090878055,
							"lng": -82.302687316
						},
						{
							"lat": 39.4090988055,
							"lng": -82.302644916
						},
						{
							"lat": 39.4090876722,
							"lng": -82.3026165827
						},
						{
							"lat": 39.4089724055,
							"lng": -82.3026093827
						},
						{
							"lat": 39.4088900055,
							"lng": -82.302609516
						},
						{
							"lat": 39.4088296055,
							"lng": -82.302559916
						},
						{
							"lat": 39.4087856055,
							"lng": -82.302510316
						},
						{
							"lat": 39.4087418055,
							"lng": -82.302460916
						},
						{
							"lat": 39.4086758722,
							"lng": -82.302432516
						},
						{
							"lat": 39.4086264055,
							"lng": -82.302439516
						},
						{
							"lat": 39.4085988722,
							"lng": -82.3024537827
						},
						{
							"lat": 39.4085768722,
							"lng": -82.302503316
						},
						{
							"lat": 39.4085714722,
							"lng": -82.3025669827
						},
						{
							"lat": 39.4085768722,
							"lng": -82.302623716
						},
						{
							"lat": 39.4085990055,
							"lng": -82.302715716
						},
						{
							"lat": 39.4086208722,
							"lng": -82.3028147827
						},
						{
							"lat": 39.4086922722,
							"lng": -82.302949316
						},
						{
							"lat": 39.4087636722,
							"lng": -82.303041316
						}
					]
				},
				{
					"points": [
						{
							"lat": 38.5326352069,
							"lng": -82.0861673164
						},
						{
							"lat": 38.5326298069,
							"lng": -82.086202183
						},
						{
							"lat": 38.5326462069,
							"lng": -82.086279183
						},
						{
							"lat": 38.5327284735,
							"lng": -82.0864261164
						},
						{
							"lat": 38.5327724735,
							"lng": -82.086440183
						},
						{
							"lat": 38.5328494069,
							"lng": -82.086440183
						},
						{
							"lat": 38.5329152735,
							"lng": -82.0863913164
						},
						{
							"lat": 38.5329428069,
							"lng": -82.0863283164
						},
						{
							"lat": 38.5329372735,
							"lng": -82.086223383
						},
						{
							"lat": 38.5329154069,
							"lng": -82.086139383
						},
						{
							"lat": 38.5328714735,
							"lng": -82.0860625164
						},
						{
							"lat": 38.5328110069,
							"lng": -82.0860205164
						},
						{
							"lat": 38.5327670735,
							"lng": -82.0860065164
						},
						{
							"lat": 38.5326682069,
							"lng": -82.086076383
						},
						{
							"lat": 38.5326352069,
							"lng": -82.0861673164
						}
					]
				},
				{
					"points": [
						{
							"lat": 38.8678206063,
							"lng": -82.2593929161
						},
						{
							"lat": 38.867644873,
							"lng": -82.2594703828
						},
						{
							"lat": 38.867535073,
							"lng": -82.2595477161
						},
						{
							"lat": 38.867463673,
							"lng": -82.2596251161
						},
						{
							"lat": 38.8674418063,
							"lng": -82.2596671828
						},
						{
							"lat": 38.8674418063,
							"lng": -82.2597023828
						},
						{
							"lat": 38.867447273,
							"lng": -82.2597305161
						},
						{
							"lat": 38.867474673,
							"lng": -82.2597725828
						},
						{
							"lat": 38.8676286063,
							"lng": -82.2599409828
						},
						{
							"lat": 38.867667073,
							"lng": -82.2599621161
						},
						{
							"lat": 38.8677110063,
							"lng": -82.2599621161
						},
						{
							"lat": 38.867738473,
							"lng": -82.2599481161
						},
						{
							"lat": 38.8677770063,
							"lng": -82.2599059161
						},
						{
							"lat": 38.8679416063,
							"lng": -82.2595333161
						},
						{
							"lat": 38.8679580063,
							"lng": -82.2594771828
						},
						{
							"lat": 38.867963473,
							"lng": -82.2594349161
						},
						{
							"lat": 38.867952473,
							"lng": -82.2593997828
						},
						{
							"lat": 38.867930473,
							"lng": -82.2593787828
						},
						{
							"lat": 38.8679030063,
							"lng": -82.2593717161
						},
						{
							"lat": 38.8678646063,
							"lng": -82.2593717828
						},
						{
							"lat": 38.8678206063,
							"lng": -82.2593929161
						}
					]
				},
				{
					"points": [
						{
							"lat": 39.3642676722,
							"lng": -82.5394967157
						},
						{
							"lat": 39.3642568056,
							"lng": -82.5395461823
						},
						{
							"lat": 39.3642566722,
							"lng": -82.5396027823
						},
						{
							"lat": 39.3642896722,
							"lng": -82.5396381823
						},
						{
							"lat": 39.3643336722,
							"lng": -82.5396665157
						},
						{
							"lat": 39.3643666056,
							"lng": -82.5396593823
						},
						{
							"lat": 39.3644104722,
							"lng": -82.5396239157
						},
						{
							"lat": 39.3644324722,
							"lng": -82.5395815823
						},
						{
							"lat": 39.3644324722,
							"lng": -82.5395391157
						},
						{
							"lat": 39.3644214722,
							"lng": -82.5394895157
						},
						{
							"lat": 39.3643886056,
							"lng": -82.5394541823
						},
						{
							"lat": 39.3643390722,
							"lng": -82.5394471157
						},
						{
							"lat": 39.3643006722,
							"lng": -82.5394471823
						},
						{
							"lat": 39.3642676722,
							"lng": -82.5394967157
						}
					]
				},
				{
					"points": [
						{
							"lat": 38.8962162063,
							"lng": -82.3783663826
						},
						{
							"lat": 38.896188673,
							"lng": -82.3784085826
						},
						{
							"lat": 38.896177673,
							"lng": -82.3784437826
						},
						{
							"lat": 38.896177673,
							"lng": -82.3784789159
						},
						{
							"lat": 38.896183273,
							"lng": -82.3785351159
						},
						{
							"lat": 38.8962052063,
							"lng": -82.3785701826
						},
						{
							"lat": 38.8962712063,
							"lng": -82.3786263826
						},
						{
							"lat": 38.896359073,
							"lng": -82.3786755826
						},
						{
							"lat": 38.8964250063,
							"lng": -82.3786895159
						},
						{
							"lat": 38.896441473,
							"lng": -82.3786825159
						},
						{
							"lat": 38.8964470063,
							"lng": -82.3786473159
						},
						{
							"lat": 38.8964524063,
							"lng": -82.3785841159
						},
						{
							"lat": 38.896441473,
							"lng": -82.3785419159
						},
						{
							"lat": 38.8964030063,
							"lng": -82.3784435159
						},
						{
							"lat": 38.8963864063,
							"lng": -82.3783733159
						},
						{
							"lat": 38.896364473,
							"lng": -82.3783171159
						},
						{
							"lat": 38.8963370063,
							"lng": -82.3783029826
						},
						{
							"lat": 38.896309473,
							"lng": -82.3783031159
						},
						{
							"lat": 38.8962600063,
							"lng": -82.3783171159
						},
						{
							"lat": 38.8962162063,
							"lng": -82.3783663826
						}
					]
				},
				{
					"points": [
						{
							"lat": 39.1858618725,
							"lng": -82.5409575157
						},
						{
							"lat": 39.1858070058,
							"lng": -82.5410561823
						},
						{
							"lat": 39.1857576058,
							"lng": -82.5410845157
						},
						{
							"lat": 39.1857192058,
							"lng": -82.5410703823
						},
						{
							"lat": 39.1857082058,
							"lng": -82.5410421157
						},
						{
							"lat": 39.1856916058,
							"lng": -82.5409575157
						},
						{
							"lat": 39.1856586725,
							"lng": -82.5409009823
						},
						{
							"lat": 39.1855982058,
							"lng": -82.5408587157
						},
						{
							"lat": 39.1855434058,
							"lng": -82.5408445823
						},
						{
							"lat": 39.1854720058,
							"lng": -82.5409009823
						},
						{
							"lat": 39.1854500058,
							"lng": -82.5409433823
						},
						{
							"lat": 39.1854444725,
							"lng": -82.5410139823
						},
						{
							"lat": 39.1854664725,
							"lng": -82.5410915823
						},
						{
							"lat": 39.1855874058,
							"lng": -82.5414021157
						},
						{
							"lat": 39.1856258058,
							"lng": -82.5413951157
						},
						{
							"lat": 39.1858016058,
							"lng": -82.5413103157
						},
						{
							"lat": 39.1860102725,
							"lng": -82.5411125823
						},
						{
							"lat": 39.1860266725,
							"lng": -82.5410843823
						},
						{
							"lat": 39.1860156725,
							"lng": -82.5409997157
						},
						{
							"lat": 39.1859278058,
							"lng": -82.5409221157
						},
						{
							"lat": 39.1858784058,
							"lng": -82.5409291823
						},
						{
							"lat": 39.1858618725,
							"lng": -82.5409575157
						}
					]
				},
				{
					"points": [
						{
							"lat": 38.7113898066,
							"lng": -82.337239316
						},
						{
							"lat": 38.7113348066,
							"lng": -82.337379516
						},
						{
							"lat": 38.7113018066,
							"lng": -82.3375055826
						},
						{
							"lat": 38.7112798066,
							"lng": -82.337652916
						},
						{
							"lat": 38.7112632066,
							"lng": -82.3378071826
						},
						{
							"lat": 38.7112466732,
							"lng": -82.3379963826
						},
						{
							"lat": 38.7112522066,
							"lng": -82.338087516
						},
						{
							"lat": 38.7112796066,
							"lng": -82.338185716
						},
						{
							"lat": 38.7113290066,
							"lng": -82.338276916
						},
						{
							"lat": 38.7113784732,
							"lng": -82.338311916
						},
						{
							"lat": 38.7114224732,
							"lng": -82.3383119826
						},
						{
							"lat": 38.7114498732,
							"lng": -82.3382909826
						},
						{
							"lat": 38.7114718732,
							"lng": -82.338241916
						},
						{
							"lat": 38.7114828732,
							"lng": -82.338178716
						},
						{
							"lat": 38.7114664066,
							"lng": -82.3381015826
						},
						{
							"lat": 38.7114280066,
							"lng": -82.3379893826
						},
						{
							"lat": 38.7114224732,
							"lng": -82.3379053826
						},
						{
							"lat": 38.7114226066,
							"lng": -82.3378351826
						},
						{
							"lat": 38.7114390732,
							"lng": -82.337744116
						},
						{
							"lat": 38.7114774732,
							"lng": -82.3375407826
						},
						{
							"lat": 38.7115050066,
							"lng": -82.337435716
						},
						{
							"lat": 38.7115544732,
							"lng": -82.337302516
						},
						{
							"lat": 38.7116314732,
							"lng": -82.3370641826
						},
						{
							"lat": 38.7116424732,
							"lng": -82.337001116
						},
						{
							"lat": 38.7116370066,
							"lng": -82.336895916
						},
						{
							"lat": 38.7116150732,
							"lng": -82.3368537826
						},
						{
							"lat": 38.7115600732,
							"lng": -82.336874916
						},
						{
							"lat": 38.7115106732,
							"lng": -82.336944916
						},
						{
							"lat": 38.7114666732,
							"lng": -82.3370289826
						},
						{
							"lat": 38.7113898066,
							"lng": -82.337239316
						}
					]
				}
			]
		}));
	});
});
